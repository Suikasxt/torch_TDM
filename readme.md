baseline（faiss全量搜索）
| k         | 1        | 5        | 10       | 20       | 50       |
|-----------|----------|----------|----------|----------|----------|
| hit_ratio | 10.3100% | 38.0600% | 55.9700% | 72.4400% | 88.0800% |
| ndcg      | 10.3100% | 11.0901% | 11.1471% | 10.9685% | 10.6183% |
| recall    | 0.0737%  | 0.4008%  | 0.8077%  | 1.5739%  | 3.7994%  |
| precision | 10.3100% | 11.2700% | 11.2660% | 10.9505% | 10.4906% |

首次建树：
| k         | 1        | 5        | 10       | 20       | 50       |
|-----------|----------|----------|----------|----------|----------|
| hit_ratio | 11.4800% | 36.8400% | 53.5600% | 70.0900% | 86.3400% |
| ndcg      | 11.4800% | 11.0109% | 10.8157% | 10.6288% | 10.2751% |
| recall    | 0.0824%  | 0.3991%  | 0.7819%  | 1.5373%  | 3.6943%  |
| precision | 11.4800% | 10.9120% | 10.6840% | 10.4910% | 10.0974% |


二次建树：
| k         | 1        | 5        | 10       | 20       | 50       |
|-----------|----------|----------|----------|----------|----------|
| hit_ratio | 11.0400% | 37.4000% | 53.5300% | 70.4900% | 86.8000% |
| ndcg      | 11.0400% | 11.1248% | 10.8822% | 10.6387% | 10.3199% |
| recall    | 0.0782%  | 0.4021%  | 0.7853%  | 1.5268%  | 3.7139%  |
| precision | 11.0400% | 11.1360% | 10.7830% | 10.4860% | 10.1520% |

时间对比：
推理时间（包含指标计算）：
| k               | 1        | 5        | 10       | 20       | 50       |
|-----------------|----------|----------|----------|----------|----------|
| baseline(faiss) | 0.9254s  | 1.5012s  | 2.1543s  | 3.4984s  | 7.6283s  |
| baseline(numpy) | 46.5725s | 47.1772s | 47.7935s | 49.2865s | 53.6695s |
| TDM             | 1.1453s  | 1.5292s  | 1.9674s  | 3.0537s  | 6.3672s  |

净搜索时间（只包含求topk，不包含指标计算）：
| k               | 1        | 5        | 10       | 20       | 50       |
|-----------------|----------|----------|----------|----------|----------|
| baseline(faiss) | 0.1003s  | 0.1010s  | 0.1015s  | 0.1092s  | 0.1313s  |
| baseline(numpy) | 45.7022s | 45.7324s | 45.7084s | 45.7172s | 45.5858s |
| TDM             | 0.3730s  | 0.6286s  | 0.9166s  | 1.6303s  | 3.3020s  |

流程：
+ 首次建树  
`python tree_index_builder.py --mode by_kmeans --input VQ_DR/deezer/data/deezer/song_embedding.npy --output ./tree.pkl --parallel 8`

+ 训练模型  
`python TDM.py`

+ 提取叶子节点embedding
`python TDM.py --best_model_pth XXX.pth --mode get_leaf`

+ 二次建树  
`python tree_index_builder.py --mode by_kmeans --input leaf_emb.npy --output ./tree_2.pkl --parallel 8 --tree_emb_path tree_emb_2.npy`

+ 训练模型  
`python TDM.py --tree_data_path tree_2.pkl --tree_emb_path tree_emb_2.npy`

改内积为DNN：  
首次建树：
| k         | 1        | 5        | 10       | 20       | 50       |
|-----------|----------|----------|----------|----------|----------|
| hit_ratio | 16.6200% | 51.5700% | 65.4300% | 77.0000% | 87.2900% |
| ndcg      | 16.6200% | 17.4139% | 16.8476% | 16.2910% | 14.7700% |
| recall    | 0.1212%  | 0.6412%  | 1.2115%  | 2.3135%  | 5.0859%  |
| precision | 16.6200% | 17.5700% | 16.6620% | 15.9530% | 14.1112% |


二次建树：
| k         | 1        | 5        | 10       | 20       | 50       |
|-----------|----------|----------|----------|----------|----------|
| hit_ratio | 21.7000% | 50.2700% | 64.0100% | 75.7500% | 86.8000% |
| ndcg      | 21.7000% | 17.4803% | 16.9262% | 16.1517% | 14.7659% |
| recall    | 0.1612%  | 0.6151%  | 1.1910%  | 2.2586%  | 5.0594%  |
| precision | 21.7000% | 16.8540% | 16.3760% | 15.5470% | 14.0420% |